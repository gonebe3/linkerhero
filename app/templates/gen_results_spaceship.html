<div class="container">
  <div class="section">
    {% if error %}
    <div class="error mb-1rem">
      {{ error }}
    </div>
    {% endif %}
    <div class="text-center mb-4">
      <h2 class="fs-2rem fw-800 c-white">âœ¨ Your AIâ€‘Crafted Draft</h2>
      <p class="c-white-80">A clear, compelling post designed to spark conversations. Polish, make it yours, and share with confidence.</p>
    </div>
    
    {% set rows = gen_rows if gen_rows is defined else [] %}
    {% if rows and rows|length > 0 %}
    {% for row in rows %}
    {% set gid = row[0] %}
    {% set v = row[1] %}
    <div class="card mb-15rem">
      <div class="card-header">
        <h3 class="c-white fs-13rem fw-700">Draft</h3>
      </div>
      
      <div class="generated-content">{{ v | replace('\n\n', '<br/><br/>') | replace('\n', '<br/>') | safe }}</div>
      
      <div class="text-center mt-3 flex gap-05 justify-center flex-wrap">
        <button class="btn btn-copy" onclick="copyToClipboard(this, `{{ v|replace('`', '\\`')|replace('\\', '\\\\')|replace('\n', '\\n') }}`)">ðŸ“‹ Copy to Clipboard</button>
        {% if gid %}
        <a class="btn" href="https://www.linkedin.com/sharing/share-offsite/?url={{ absolute_url('share/preview/' ~ gid) }}" target="_blank" rel="noopener">Share on LinkedIn</a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
    {% else %}
    {% for v in variants %}
    <div class="card mb-15rem">
      <div class="card-header">
        <h3 class="c-white fs-13rem fw-700">Draft</h3>
      </div>
      
      <div class="generated-content">{{ v | replace('\n\n', '<br/><br/>') | replace('\n', '<br/>') | safe }}</div>
      
      <div class="text-center mt-3">
        <button class="btn btn-copy" onclick="copyToClipboard(this, `{{ v|replace('`', '\\`')|replace('\\', '\\\\')|replace('\n', '\\n') }}`)">ðŸ“‹ Copy to Clipboard</button>
      </div>
    </div>
    {% endfor %}
    {% endif %}
    
    <div class="text-center">
      <a href="/generate" class="btn btn-secondary">ðŸ”„ Generate More Posts</a>
      {% if session.get('user_id') %}
      <a href="/news" class="btn ml-1rem">ðŸ“° Browse Articles</a>
      {% endif %}
    </div>
  </div>
</div>

<script>
function copyToClipboard(button, text) {
  navigator.clipboard.writeText(text).then(function() {
    const originalText = button.innerHTML;
    button.innerHTML = 'âœ… Copied!';
    button.style.background = 'linear-gradient(135deg, #10b981, #059669)';
    
    setTimeout(() => {
      button.innerHTML = originalText;
      button.style.background = '';
    }, 2000);
    
    // Show notification
    showNotification('Post copied to clipboard!', 'success');
  }).catch(function(err) {
    console.error('Failed to copy text: ', err);
    showNotification('Failed to copy text', 'error');
  });
}
</script>
