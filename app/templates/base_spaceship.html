<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content="{{ csrf_token() }}" />
    <title>{{ app_name }} - AI-Powered LinkedIn Post Generator</title>
    {{ css('spaceship.css')|safe }}
    <style>
      /* Keep flash/error messages visible below the fixed header */
      .flash-container { margin-top: calc(70px + 12px); }

      /* OAuth buttons (Login/Register) */
      .oauth-buttons {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .btn-oauth {
        width: 100%;
        min-height: 48px;
        padding: 12px 18px;
        border-radius: 999px;
        gap: 12px;
      }

      .btn-oauth .oauth-icon {
        width: 20px;
        height: 20px;
        object-fit: contain;
        flex: 0 0 20px;
      }
    </style>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  </head>
  <body class="{{ body_class|default('') }}">
    <nav class="nav">
      <div class="nav-container">
        <a href="/" class="nav-brand">LinkerHero</a>
        <div class="nav-links">
          {% if session.get('user_id') %}
          <a href="/me/dashboard">Dashboard</a>
          {% else %}
          <a href="/">Home</a>
          {% endif %}
          {% if session.get('user_id') %}
          <a href="/news">Content Fuel</a>
          {% endif %}
          <a href="/pricing">Pricing</a>
          {% if session.get('user_id') %}
          <a href="/generate">Generate</a>
          <a href="/logout">Logout</a>
          {% else %}
          <a href="/login">Login</a>
          <a href="/register" class="btn btn-cta px-16 py-08 rounded-10">Try it for Free</a>
          {% endif %}
        </div>
      </div>
    </nav>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="container flash-container">
      {% for category, m in messages %}
      <div class="{{ 'error' if category in ['error','danger'] else 'success' if category in ['success'] else 'card p-05 bg-soft border-soft' }} mb-1">{{ m }}</div>
      {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
    
    <main>
      {% block content %}{% endblock %}
    </main>
    
    {% include 'partials/footer.html' %}

    <script src="{{ url_for('static', filename='js/spaceship.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}" type="module"></script>
  </body>
  <script>
    (function(){
      try {
        var token = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
        if (window.htmx) {
          document.body.addEventListener('htmx:configRequest', function (event) {
            event.detail.headers['X-CSRFToken'] = token;
          });
        }
        window.__CSRF_TOKEN__ = token;
      } catch (_) {}
    })();
  </script>
</html>
